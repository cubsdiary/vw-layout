webpackJsonp([11],{D0t5:function(t,i){},Fk44:function(t,i){},Sm5a:function(t,i){},gF1Q:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=s("woOf"),n=s.n(a),e=s("Dd8w"),o=s.n(e),r=s("+aT9"),c=s.n(r),h={props:{washinfo:{type:Object,required:!0}},methods:{closewindow:function(){this.$emit("closewindow",!1)},_openLocation:function(){this.Wx.openLocation({latitude:parseFloat(this.washinfo.lat),longitude:parseFloat(this.washinfo.lng),name:this.washinfo.title,address:this.washinfo.address,scale:18})}},mounted:function(){}},l={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("transition",{attrs:{name:"show"}},[s("div",{staticClass:"wash-info"},[s("div",{staticClass:"header"},[s("h2",[t._v("洗车服务详情")]),t._v(" "),s("div",{staticClass:"close",on:{click:t.closewindow}})]),t._v(" "),s("div",{staticClass:"content"},[s("ul",t._l(t.washinfo.washinfo,function(i,a){return s("li",{key:a},[s("div",{staticClass:"left"},[s("div",{staticClass:"img",class:"bg"+i.type}),t._v(" "),s("div",{staticClass:"info"},[s("h2",[t._v(t._s(i.name))]),t._v(" "),s("p",[t._v(t._s(i.info))])])]),t._v(" "),s("div",{staticClass:"right"},[t._v("\n            ￥"+t._s(i.price.toFixed(2))+"\n          ")])])}))]),t._v(" "),s("div",{staticClass:"footer",on:{click:t._openLocation}},[s("span",{staticClass:"bg"},[t._v("\n        去这里\n      ")])])])])},staticRenderFns:[]};var f=s("VU/8")(h,l,!1,function(t){s("Sm5a")},"data-v-3a3483f6",null).exports,d=s("NYxO"),p={data:function(){return{map:null,geolocation:null,customMarker:null,showMap:!1,markerDom:[],preMarkerId:-1,infoWindow:null,washinfoShow:!1,washForShow:null,storeList:[],markers:[],washType:"",washinfo:[{type:1,name:"普洗",info:"整车泡沫冲洗擦干、轮胎、轮毂冲洗清洁、车内吸尘、内饰脚垫等简单除尘",price:30},{type:2,name:"精洗",info:"整车泡沫冲洗擦干、轮胎轮毂冲洗清洁、边缝清洗、发动机舱清洁、车内精致清洁",price:60},{type:3,name:"超精洗",info:"边缝清洗、发动机舱清洁、车内精致清洁，整车泡沫冲洗擦干、轮胎轮毂冲洗清洁",price:90}]}},watch:{preMarkerId:function(t,i){this.washForShow=this.markers[t]}},methods:o()({_goSearch:function(){this.$router.push("/search-list?format=store")},_goBack:function(){this.$router.go(-1)},_setMap:function(){var t=this;this.map=new c.a.Map(this.$refs.container,{resizeEnable:!0,jogEnable:!1,center:[this.cityInfo.lng,this.cityInfo.lat],zoom:13,zooms:[12,19]}),c.a.event.addListener(t.map,"click",function(i){t._closeAll()}),t._onComplete(this.cityInfo)},_onComplete:function(t){this.showMap?this.map.panTo([t.lng,t.lat]):(this.showMap=!0,this.customMarker=new c.a.Marker({map:this.map,position:[t.lng,t.lat],offset:new c.a.Pixel(-11,-34),icon:new c.a.Icon({image:"./static/own_marker@2x.png",size:new c.a.Size(22,34)})}))},_onClick:function(t){this.washinfoShow=!0,this._reductionMarker();var i=t.target.getExtData();this.markerActive(i)},markerActive:function(t){this.markerDom[t].setMap(null),this.markerDom[t]=new c.a.Marker({map:this.map,offset:new c.a.Pixel(-22,-22),position:[this.markers[t].lng,this.markers[t].lat],icon:new c.a.Icon({image:this.markers[t].icon,size:new c.a.Size(44,44)}),extData:t,clickable:!0}),this.preMarkerId=t,this._setInfoWindow(this.markers[t])},_reductionMarker:function(){var t=this.preMarkerId;-1!==t&&(this.markerDom[t].setMap(null),this._setMarker(this.markers[t],t))},_getLocation:function(){var t=this;this.map.plugin("AMap.Geolocation",function(){t.geolocation=new c.a.Geolocation({enableHighAccuracy:!0,timeout:1e3,maximumAge:0,convert:!0,showButton:!1,showMarker:!1,showCircle:!1,panToLocation:!0,zoomToAccuracy:!1}),t.map.addControl(t.geolocation),t.geolocation.getCurrentPosition(function(i,s){"complete"===s.type&&"SUCCESS"===s.info&&t._onComplete(s.position)})})},_getMarker:function(){var t=this,i=/维修/,s=new c.a.LngLat(this.cityInfo.lng,this.cityInfo.lat);this.storeList.forEach(function(a,e){var o=i.test(a.name);a=n()(a,{washinfo:t.setWashinfo(o),icon:"./static/active_"+(o?"wx":"by")+"_store@2x.png",way:s.distance([a.lng,a.lat]),type:o?1:2}),t._setMarker(a,e,o)}),this.markers=this.storeList,"serach"===this.washType&&this.serachInfo.address&&this.serachActive()},setWashinfo:function(t){if(t)return this.washinfo;var i=[];return this.washinfo.forEach(function(t,s){2!==s&&i.push(t)}),i},_setMarker:function(t,i,s){this.markerDom[i]=new c.a.Marker({map:this.map,offset:new c.a.Pixel(-17,-17),position:[t.lng,t.lat],content:'<div class="marker-com '+(s?"wx":"by")+'">\n                    <div class="new '+(t.new?"":"show")+'" ></div>\n                    <div class="marker-txt">\n                      <span>'+t.name.slice(8,t.length)+'</span>\n                      <div class="state bg'+t.state+'">'+(1===t.state?"空闲":"繁忙")+"</div>\n                    </div>\n                  </div>",extData:i,clickable:!0}),this.markerDom[i].on("click",this._onClick)},_setInfoWindow:function(t){var i=this.formatKm(t.way);this.infoWindow=new c.a.InfoWindow({isCustom:!0,offset:new c.a.Pixel(0,-24),content:'<div class="window-info">\n                    <div class="left">\n                      <h2>'+t.name.slice(8,t.length)+"</h2>\n                      <p>"+t.address+'</p>\n                    </div>\n                    <div class="right"><h2>'+i+'km</h2><span class="'+(t.mostfar?"show":"")+'">距您最近</span></div>\n                    <div class="state bg'+t.state+'">'+(1===t.state?"空闲":"繁忙")+"</div>\n                  </div>"}),this.infoWindow.open(this.map,[t.lng,t.lat]),this.map.panTo([t.lng,t.lat]),this.map.panBy(0,-80)},_closeInfoWindow:function(){this.infoWindow.close()},_closeAll:function(){this.washinfoShow=!1,this.infoWindow.close(),this._reductionMarker()},getStoreList:function(t,i){var s=this;this.api_post("api/store/storeList",function(t){0===t.errorCode&&(s.storeList=t.data,s._setMap(),s._getMarker(),s.setStoreList(t.data))},{page:1,limit:50,lng:t||"",lat:i||""})},formatKm:function(t){return(parseInt(t)/1e3).toFixed(2)},serachActive:function(){var t=this,i=0;this.storeList.forEach(function(s,a){s.id===t.serachInfo.id&&(i=a)}),this.washinfoShow=!0,this.markerActive(i)}},Object(d.c)({setStoreList:"SET_STORELIST"})),computed:o()({},Object(d.b)(["cityInfo","serachInfo"])),created:function(){this.getStoreList(),this.washType=this.$route.query.type},components:{washInfo:f}},w={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"detection-record",attrs:{flexContainer:""}},[s("div",{staticClass:"action-bar"},[s("div",{staticClass:"go-back",on:{click:t._goBack}}),t._v(" "),s("div",{staticClass:"font"}),t._v(" "),s("div",{staticClass:"search",on:{click:t._goSearch}})]),t._v(" "),s("div",{ref:"container",staticClass:"container",class:t.showMap?"show":""},[s("div",{staticClass:"map-btn"},[s("div",{staticClass:"map-location",on:{click:t._getLocation}}),t._v(" "),s("div",{staticClass:"bor"}),t._v(" "),s("div",{staticClass:"map-kf"})])]),t._v(" "),t.washinfoShow?s("washInfo",{attrs:{washinfo:t.washForShow},on:{closewindow:t._closeAll}}):t._e()],1)},staticRenderFns:[]};var m=s("VU/8")(p,w,!1,function(t){s("D0t5"),s("Fk44")},"data-v-b6cc296a",null);i.default=m.exports}});
//# sourceMappingURL=11.232476c493b1d4d5277c.js.map