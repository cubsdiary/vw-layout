webpackJsonp([11],{J2EN:function(t,s){},bgTF:function(t,s){},crKl:function(t,s){},gF1Q:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=i("aA9S"),n=i.n(a),e=i("4YfN"),o=i.n(e),r=i("+aT9"),c=i.n(r),h={props:{washinfo:{type:Object,required:!0}},methods:{closewindow:function(){this.$emit("closewindow",!1)},_openLocation:function(){this.Wx.openLocation({latitude:this.washinfo.lat,longitude:this.washinfo.lng,name:this.washinfo.title,address:this.washinfo.address,scale:18})}},mounted:function(){}},l={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("transition",{attrs:{name:"show"}},[i("div",{staticClass:"wash-info"},[i("div",{staticClass:"header"},[i("h2",[t._v("洗车服务详情")]),t._v(" "),i("div",{staticClass:"close",on:{click:t.closewindow}})]),t._v(" "),i("div",{staticClass:"content"},[i("ul",t._l(t.washinfo.washinfo,function(s,a){return i("li",{key:a},[i("div",{staticClass:"left"},[i("div",{staticClass:"img",class:"bg"+s.type}),t._v(" "),i("div",{staticClass:"info"},[i("h2",[t._v(t._s(s.name))]),t._v(" "),i("p",[t._v(t._s(s.info))])])]),t._v(" "),i("div",{staticClass:"right"},[t._v("\n            ￥"+t._s(s.price.toFixed(2))+"\n          ")])])}))]),t._v(" "),i("div",{staticClass:"footer",on:{click:t._openLocation}},[i("span",{staticClass:"bg"},[t._v("\n        去这里\n      ")])])])])},staticRenderFns:[]};var f=i("Z0/y")(h,l,!1,function(t){i("crKl")},"data-v-6c2ce575",null).exports,d=i("9rMa"),m={data:function(){return{map:null,geolocation:null,customMarker:null,showMap:!1,markerDom:[],preMarkerId:-1,infoWindow:null,washinfoShow:!1,washForShow:null,storeList:[],markers:[],washType:"",washinfo:[{type:1,name:"普洗",info:"整车泡沫冲洗擦干、轮胎、轮毂冲洗清洁、车内吸尘、内饰脚垫等简单除尘",price:30},{type:2,name:"精洗",info:"整车泡沫冲洗擦干、轮胎轮毂冲洗清洁、边缝清洗、发动机舱清洁、车内精致清洁",price:60},{type:3,name:"超精洗",info:"边缝清洗、发动机舱清洁、车内精致清洁，整车泡沫冲洗擦干、轮胎轮毂冲洗清洁",price:90}]}},watch:{preMarkerId:function(t,s){this.washForShow=this.markers[t]}},methods:o()({_goSearch:function(){this.$router.push("/search-list?format=store")},_goBack:function(){this.$router.go(-1)},_setMap:function(){var t=this;this.map=new c.a.Map(this.$refs.container,{resizeEnable:!0,jogEnable:!1,center:[this.cityInfo.lng,this.cityInfo.lat],zoom:13,zooms:[12,19]}),c.a.event.addListener(t.map,"click",function(s){t._closeAll()}),t._onComplete(this.cityInfo)},_onComplete:function(t){this.showMap?this.map.panTo([t.lng,t.lat]):(this.showMap=!0,this.customMarker=new c.a.Marker({map:this.map,position:[t.lng,t.lat],offset:new c.a.Pixel(-11,-34),icon:new c.a.Icon({image:"./static/own_marker@2x.png",size:new c.a.Size(22,34)})}))},_onClick:function(t){this.washinfoShow=!0,this._reductionMarker();var s=t.target.getExtData();this.markerActive(s)},markerActive:function(t){this.markerDom[t].setMap(null),this.markerDom[t]=new c.a.Marker({map:this.map,offset:new c.a.Pixel(-22,-22),position:[this.markers[t].lng,this.markers[t].lat],icon:new c.a.Icon({image:this.markers[t].icon,size:new c.a.Size(44,44)}),extData:t,clickable:!0}),this.preMarkerId=t,this._setInfoWindow(this.markers[t])},_reductionMarker:function(){var t=this.preMarkerId;-1!==t&&(this.markerDom[t].setMap(null),this._setMarker(this.markers[t],t))},_getLocation:function(){var t=this;this.map.plugin("AMap.Geolocation",function(){t.geolocation=new c.a.Geolocation({enableHighAccuracy:!0,timeout:1e3,maximumAge:0,convert:!0,showButton:!1,showMarker:!1,showCircle:!1,panToLocation:!0,zoomToAccuracy:!1}),t.map.addControl(t.geolocation),t.geolocation.getCurrentPosition(function(s,i){"complete"===i.type&&"SUCCESS"===i.info&&t._onComplete(i.position)})})},_getMarker:function(){var t=this,s=/维修/,i=new c.a.LngLat(this.cityInfo.lng,this.cityInfo.lat);this.storeList.forEach(function(a,e){var o=s.test(a.name);a=n()(a,{washinfo:t.setWashinfo(o),icon:"./static/active_"+(o?"wx":"by")+"_store@2x.png",way:i.distance([a.lng,a.lat]),type:o?1:2}),t._setMarker(a,e,o)}),this.markers=this.storeList,"serach"===this.washType&&this.serachInfo.address&&this.serachActive()},setWashinfo:function(t){if(t)return this.washinfo;var s=[];return this.washinfo.forEach(function(t,i){2!==i&&s.push(t)}),s},_setMarker:function(t,s,i){this.markerDom[s]=new c.a.Marker({map:this.map,offset:new c.a.Pixel(-17,-17),position:[t.lng,t.lat],content:'<div class="marker-com '+(i?"wx":"by")+'">\n                    <div class="new '+(t.new?"":"show")+'" ></div>\n                    <div class="marker-txt">\n                      <span>'+t.name.slice(8,t.length)+'</span>\n                      <div class="state bg'+t.state+'">'+(1===t.state?"空闲":"繁忙")+"</div>\n                    </div>\n                  </div>",extData:s,clickable:!0}),this.markerDom[s].on("click",this._onClick)},_setInfoWindow:function(t){var s=this.formatKm(t.way);this.infoWindow=new c.a.InfoWindow({isCustom:!0,offset:new c.a.Pixel(0,-24),content:'<div class="window-info">\n                    <div class="left">\n                      <h2>'+t.name.slice(8,t.length)+"</h2>\n                      <p>"+t.address+'</p>\n                    </div>\n                    <div class="right"><h2>'+s+'km</h2><span class="'+(t.mostfar?"show":"")+'">距您最近</span></div>\n                    <div class="state bg'+t.state+'">'+(1===t.state?"空闲":"繁忙")+"</div>\n                  </div>"}),this.infoWindow.open(this.map,[t.lng,t.lat]),this.map.panTo([t.lng,t.lat]),this.map.panBy(0,-100)},_closeInfoWindow:function(){this.infoWindow.close()},_closeAll:function(){this.washinfoShow=!1,this.infoWindow.close(),this._reductionMarker()},getStoreList:function(t,s){var i=this;this.api_post("api/store/storeList",function(t){0===t.errorCode&&(i.storeList=t.data,i._setMap(),i._getMarker(),i.setStoreList(t.data))},{page:1,limit:50,lng:t||"",lat:s||""})},formatKm:function(t){return(parseInt(t)/1e3).toFixed(2)},serachActive:function(){var t=this,s=0;this.storeList.forEach(function(i,a){i.id===t.serachInfo.id&&(s=a)}),this.washinfoShow=!0,this.markerActive(s)}},Object(d.c)({setStoreList:"SET_STORELIST"})),computed:o()({},Object(d.b)(["cityInfo","myCar","serachInfo"])),created:function(){this.getStoreList(),this.washType=this.$route.query.type},components:{washInfo:f}},p={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"detection-record",attrs:{flexContainer:""}},[i("div",{staticClass:"action-bar"},[i("div",{staticClass:"go-back",on:{click:t._goBack}}),t._v(" "),i("div",{staticClass:"font"},[i("h2",[t._v(t._s(t.myCar[0].series.sbName+" - "+t.myCar[0].series.vehicleSystem[1]))]),t._v(" "),i("p",[i("span",[t._v(t._s(t.myCar[0].idCard))]),i("span",[t._v("丨")]),i("span",[t._v(t._s(t.myCar[0].way)+"km")])])]),t._v(" "),i("div",{staticClass:"search",on:{click:t._goSearch}})]),t._v(" "),i("div",{ref:"container",staticClass:"container",class:t.showMap?"show":""},[i("div",{staticClass:"map-btn"},[i("div",{staticClass:"map-location",on:{click:t._getLocation}}),t._v(" "),i("div",{staticClass:"bor"}),t._v(" "),i("div",{staticClass:"map-kf"})])]),t._v(" "),t.washinfoShow?i("washInfo",{attrs:{washinfo:t.washForShow},on:{closewindow:t._closeAll}}):t._e()],1)},staticRenderFns:[]};var w=i("Z0/y")(m,p,!1,function(t){i("bgTF"),i("J2EN")},"data-v-b3ac487a",null);s.default=w.exports}});
//# sourceMappingURL=11.e021434531f0bf64ed43.js.map